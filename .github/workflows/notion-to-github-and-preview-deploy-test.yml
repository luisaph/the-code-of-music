name: Notion2Github and Preview Deploy Test
on:
  workflow_dispatch:
jobs:
  auto-sync-from-notion-to-github:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Notion2Github
        uses: 43-stuti/notion-github@v1.3
        with:
          SECRET_GITHUB: ${{secrets.TOKEN_GITHUB}}
          NOTION_SECRET: ${{secrets.TOKEN_NOTION}}
          OWNER: 'luisaph'
          REPO: 'the-code-of-music'
          BLOCK_NAME: 'Book'

      - name: Install and Build ðŸ”§
        run: |
          yarn install
          yarn build

      - name: Deploy to Staging ðŸš€
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: '${{ secrets.GITHUB_TOKEN }}'
          firebaseServiceAccount: '${{ secrets.FIREBASE_SERVICE_ACCOUNT_CODEOFMUSIC_16A81 }}'
          projectId: codeofmusic-16a81
          channelId: staging
